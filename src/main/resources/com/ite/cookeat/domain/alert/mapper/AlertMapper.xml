<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ite.cookeat.domain.alert.mapper.AlertMapper">

  <insert id="insertEventAlertMember" parameterType="PostEventAlertMemberReq">
    <selectKey keyProperty="alertId" order="BEFORE" resultType="Integer">
      SELECT alert_seq.nextval AS alertId FROM dual
    </selectKey>
    INSERT INTO alert (alert_id, member_id, event_id)
    SELECT #{alertId}, m.member_id, #{eventId}
    FROM member m
    WHERE m.username = #{username}
    AND m.status = 'ACTIVE'
  </insert>
</mapper>